@{
    ViewData["Title"] = "Home Page";
    var path = Context.Request.Path.Value;
    var pathLowercase = path.ToLower();
}

@inject Website.Services.IVideoRepository _videoRepository
@inject Website.Services.IIsaacRepository _isaacRepository

<script src="~/js/dist/runtime.min.js"></script>
<script src="~/js/dist/vendor.min.js"></script>
<script src="~/js/dist/framework.min.js"></script>

@switch (pathLowercase)
{
    case "/":
        <script src="~/js/dist/home.min.js"></script>
        break;
    case "/downloads":
        <script src="~/js/dist/downloads.min.js"></script>
        break;
    case "/episodes":
        <script src="~/js/dist/episodes.min.js"></script>
        break;
    case "/items":
    case "/bosses":
    case "/characters":
    case "/itemsources":
    case "/floors":
    case "/transformations":
    case "/characterrerolls":
    case "/curses":
    case "/pills":
    case "/runes":
    case "/tarotcards":
    case "/trinkets":
    case "/otherconsumables":
        <script src="~/js/dist/resource_overview.min.js"></script>
        break;

    @* check if video ID was requested: 11 characters + leading slash *@
    case string potentialVideoId when potentialVideoId.Length == 12 && await _videoRepository.VideoExists(path.Substring(1)):
        <script src="~/js/dist/episode.min.js"></script>
        break;

    @* check if a isaac resource was requested *@
    case string isaacResource when await _isaacRepository.ResourceExists(path.Substring(1)):
        <script src="~/js/dist/resource.min.js"></script>
        break;

    @* if nothing was found, just return 'Home' *@
    default:
        <script src="~/js/dist/home.min.js"></script>
        break;
}


<script src="~/js/dist/all_remaining_pages.min.js" async defer></script>


